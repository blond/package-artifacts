#!/usr/bin/env node

'use strict';

const meow = require('meow');
const tartifacts = require('../');
const cliHelpers = require('../lib/cli-helpers');

const cli = meow(`
    Usage
      $ tartifacts

    Options
      -i, --include   Paths to inlcude files
      -e, --exclude   Paths to exclude files
      -p, --patterns  Path to file with include and exclude patterns
      -d, --dest      Path to destination file
      -r, --root      Path to root directory
      -c, --config    Path to config

    Examples
      $ tartifacts --include="lib/**" --exclude="node_modules/" --dest="artifact.tar.gz"
      $ tartifacts --patterns="./path/to/patterns" --dest="artifact.tar.gz"
      $ tartifacts --config=.config/tartifacts/pull-request.js
`, {
	alias: {
        h: 'help',
        v: 'version',
        i: 'include',
        e: 'exclude',
        p: 'patterns',
        d: 'dest',
        r: 'root',
        c: 'config'
	}
});

const flags = cli.flags;

if (Object.keys(flags).length === 0) {
    cli.showHelp();
} else {
    tartifacts(cliHelpers.getArtifactsInfoList(flags), {
        root: flags.root
    });
}
